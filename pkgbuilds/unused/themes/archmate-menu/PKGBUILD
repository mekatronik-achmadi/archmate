pkgname=archmate-menu
_pkgname=brisk-menu
_matepkg=mate-menu
_matever=22.04.2
pkgver=0.6.2
pkgrel=1
pkgdesc="Brisk-Menu and Mint-Menu for Mate Desktop"
arch=('x86_64')
url="https://github.com/getsolus/brisk-menu"
license=('GPL')
groups=('mate-extra')
depends=('mate-panel' 'libnotify'
'python-configobj' 'python-gobject'
'python-xdg' 'python-xlib'
'xdg-utils' 'python-setproctitle'
'mate-menus' 'python-cairo')
makedepends=('gnome-common' 'gettext' 'itstool' 'vala>=0.36' 'meson' 'ninja' )
provides=('brisk-menu')
conflicts=('brisk-menu')
install=
source=(
"https://github.com/getsolus/brisk-menu/releases/download/v${pkgver}/brisk-menu-v$pkgver.tar.xz"
"$_matepkg-$_matever.tar.gz::https://github.com/ubuntu-mate/mate-menu/archive/$_matever.tar.gz")
sha256sums=(
    '5a87f4dcf7365e81a571128bf0b8199eb06a6fcd7e15ec7739be0ccff1326488'
    '36aa865b72664b8cc90d9c1c429fd3c44e2c198369aae4eaaa87228a5add075c')

build() {
	cd "${srcdir}/${_pkgname}-${pkgver}"

	meson --buildtype plain build \
		--prefix=/usr \
		--bindir=/usr/bin \
		--libexecdir=/usr/lib/${pkgname}

	ninja -C build -j$(($(getconf _NPROCESSORS_ONLN)+1))
}


package() {
    cd "${srcdir}"
    install -d $pkgdir/usr/share/glib-2.0/schemas/
	cp -f ../archmate-menu.gschema.override $pkgdir/usr/share/glib-2.0/schemas/

	cd "${srcdir}/${_pkgname}-${pkgver}/build"

	DESTDIR="${pkgdir}" ninja install

    cd "${srcdir}/${_matepkg}-${_matever}"
    python setup.py install --root="$pkgdir" --optimize=1
}

